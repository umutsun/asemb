<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASB Control Center</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <div class="control-center">
        <header class="main-header">
            <h1>🌉 Alice Semantic Bridge Control Center</h1>
            <div class="status-bar">
                <span class="status-item" id="system-status">System: <span class="status-indicator active">Online</span></span>
                <span class="status-item" id="api-status">API: <span class="status-indicator">Checking...</span></span>
                <span class="status-item" id="redis-status">Redis: <span class="status-indicator">Checking...</span></span>
                <span class="status-item" id="n8n-status">n8n: <span class="status-indicator">Checking...</span></span>
            </div>
        </header>

        <!-- Tab Navigation -->
        <nav class="tab-nav">
            <button class="tab-button active" onclick="showTab('overview')">📊 Overview</button>
            <button class="tab-button" onclick="showTab('lightrag')">🧠 Knowledge Graph</button>
            <button class="tab-button" onclick="showTab('agents')">🤖 Agents</button>
            <button class="tab-button" onclick="showTab('workflows')">🔄 Workflows</button>
        </nav>

        <!-- Overview Tab -->
        <div id="overview-tab" class="tab-content active">
            <div class="dashboard-grid">
                <!-- Project Overview -->
                <section class="card project-overview">
                    <h2>📁 Project Overview</h2>
                    <div class="project-info">
                        <div class="info-row">
                            <span class="label">Current Project:</span>
                            <span class="value" id="current-project">alice-semantic-bridge</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Version:</span>
                            <span class="value">v1.0.0</span>
                        </div>
                        <div class="info-row">
                            <span class="label">Environment:</span>
                            <span class="value" id="environment">Development</span>
                        </div>
                    </div>
                </section>

                <!-- Agent Status Grid -->
                <section class="card agents-status">
                    <h2>🤖 Agent Status</h2>
                    <div class="agents-grid">
                        <div class="agent-box" id="claude-status">
                            <div class="agent-icon">🧠</div>
                            <h3>Claude</h3>
                            <p class="agent-role">Architecture Lead</p>
                            <div class="agent-metrics">
                                <span class="metric">Tasks: <strong id="claude-tasks">0</strong></span>
                                <span class="metric">Memory: <strong id="claude-memory">0MB</strong></span>
                            </div>
                        </div>
                        <div class="agent-box" id="gemini-status">
                            <div class="agent-icon">🌟</div>
                            <h3>Gemini</h3>
                            <p class="agent-role">Performance Engineer</p>
                            <div class="agent-metrics">
                                <span class="metric">Tasks: <strong id="gemini-tasks">0</strong></span>
                                <span class="metric">Memory: <strong id="gemini-memory">0MB</strong></span>
                            </div>
                        </div>
                        <div class="agent-box" id="codex-status">
                            <div class="agent-icon">💻</div>
                            <h3>Codex</h3>
                            <p class="agent-role">Implementation Lead</p>
                            <div class="agent-metrics">
                                <span class="metric">Tasks: <strong id="codex-tasks">0</strong></span>
                                <span class="metric">Memory: <strong id="codex-memory">0MB</strong></span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Performance Metrics -->
                <section class="card performance-metrics">
                    <iframe src="components/MetricsPanel.html" style="width: 100%; height: 100%; border: none;"></iframe>
                </section>

                <!-- n8n Workflow Status -->
                <section class="card workflow-status">
                    <h2>🔄 n8n Workflow Status</h2>
                    <div class="workflow-list" id="workflow-list">
                        <div class="workflow-item">
                            <span class="workflow-name">Loading workflows...</span>
                        </div>
                    </div>
                </section>

                <!-- Redis Memory Status -->
                <section class="card redis-monitor">
                    <h2>💾 Redis Memory Monitor</h2>
                    <canvas id="redis-chart"></canvas>
                    <div class="redis-stats">
                        <span>Used: <strong id="redis-used">0MB</strong></span>
                        <span>Peak: <strong id="redis-peak">0MB</strong></span>
                        <span>Keys: <strong id="redis-keys">0</strong></span>
                    </div>
                </section>

                <!-- Activity Log -->
                <section class="card activity-log">
                    <h2>📜 Activity Log</h2>
                    <div class="log-container" id="activity-log">
                        <!-- Log entries will be added here -->
                    </div>
                </section>
            </div>
        </div>

        <!-- LightRAG Tab -->
        <div id="lightrag-tab" class="tab-content">
            <div id="lightrag-container" style="width: 100%; min-height: 800px;">
                <!-- LightRAG dashboard will be loaded here -->
            </div>
        </div>

        <!-- Agents Tab -->
        <div id="agents-tab" class="tab-content">
            <div class="dashboard-grid">
                <!-- Agent details will go here -->
            </div>
        </div>

        <!-- Workflows Tab -->
        <div id="workflows-tab" class="tab-content">
            <div class="dashboard-grid">
                <!-- Workflow details will go here -->
            </div>
        </div>

        <!-- Control Panel -->
        <section class="control-panel">
            <h2>🎮 Control Panel</h2>
            <div class="controls">
                <button class="btn btn-primary" onclick="deployToProduction()">🚀 Deploy to Production</button>
                <button class="btn btn-secondary" onclick="runTests()">🧪 Run Tests</button>
                <button class="btn btn-secondary" onclick="clearCache()">🗑️ Clear Cache</button>
                <button class="btn btn-info" onclick="refreshStatus()">🔄 Refresh Status</button>
            </div>
        </section>
    </div>

    <script src="dashboard.js"></script>
    <script src="components/lightrag/lightrag-dashboard.js"></script>
    
    <style>
        /* Tab Navigation Styles */
        .tab-nav {
            display: flex;
            gap: 10px;
            padding: 10px 20px;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
        }
        
        .tab-button {
            padding: 10px 20px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px 4px 0 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab-button:hover {
            background: #f0f0f0;
        }
        
        .tab-button.active {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Ensure grid layout works in tabs */
        #overview-tab .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 0;
        }
    </style>
    
    <script>
        // Tab switching function
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
            
            // Initialize LightRAG when its tab is shown
            if (tabName === 'lightrag' && !window.lightRAG) {
                window.lightRAG = new LightRAGDashboard('lightrag-container');
            }
        }
    </script>
</body>
</html>